<div class="container">
  <button mat-button color="primary" (click)="openDialog(null)">
    Novo Lote
  </button>

  <table mat-table #table [dataSource]="dataSource" class="mat-elevation-z8">
    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef>#</th>
      <td mat-cell *matCellDef="let batch">{{ batch.id }}</td>
    </ng-container>

    <ng-container matColumnDef="materialName">
      <th mat-header-cell *matHeaderCellDef>Material</th>
      <td mat-cell *matCellDef="let batch">
        {{ batch.material.name }}
      </td>
    </ng-container>

    <ng-container matColumnDef="qualityVisionName">
      <th mat-header-cell *matHeaderCellDef>Visão</th>
      <td mat-cell *matCellDef="let batch">
        {{ batch.qualityVision.name }}
      </td>
    </ng-container>

    <ng-container matColumnDef="createdAt">
      <th mat-header-cell *matHeaderCellDef>Criação</th>
      <td mat-cell *matCellDef="let batch">
        {{ batch.createdAt }}
      </td>
    </ng-container>

    <ng-container matColumnDef="minQuantity">
      <th mat-header-cell *matHeaderCellDef>Qtd. Mínima</th>
      <td mat-cell *matCellDef="let batch">
        {{ batch.qualityVision.avaliationMethodology.minQuantity }}
      </td>
    </ng-container>

    <ng-container matColumnDef="grouping">
      <th mat-header-cell *matHeaderCellDef>Agrupamento</th>
      <td mat-cell *matCellDef="let batch">
        {{
          batch.qualityVision.avaliationMethodology.grouping == "First"
            ? "Primeiro(s)"
            : "Último(s)"
        }}
      </td>
    </ng-container>

    <ng-container matColumnDef="calculationType">
      <th mat-header-cell *matHeaderCellDef>Tipo de Cálculo</th>
      <td mat-cell *matCellDef="let batch">
        {{
          batch.qualityVision.avaliationMethodology.calculationType ==
          "Median"
            ? "Média"
            : "Não Identificado"
        }}
      </td>
    </ng-container>

    <ng-container matColumnDef="amountOfTests">
      <th mat-header-cell *matHeaderCellDef>Ensaios Adicionados</th>
      <td mat-cell *matCellDef="let batch">
        {{ batch.amountOfTests }}
      </td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Status</th>
      <td mat-cell *matCellDef="let batch">
        {{ translations[batch.status] }}
      </td>
    </ng-container>

    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef>Ação</th>
      <td mat-cell *matCellDef="let batch">
        <button
          mat-icon-button
          (click)="onAddTest(batch)"
          matTooltip="Adicionar Ensaio"
          matTooltipPosition="above"
        >
          <mat-icon>add</mat-icon>
        </button>

        <button
          mat-icon-button
          (click)="onCheckTests(batch)"
          matTooltip="Adicionar Ensaio"
          matTooltipPosition="above"
        >
          <mat-icon>quiz</mat-icon>
        </button>
        <!-- TODO: adicionar edição -->
        <!-- <button
          mat-icon-button
          color="primary"
          (click)="onEditMaterial(batch)"
        >
          <mat-icon>edit</mat-icon>
        </button>-->
        <button
          mat-icon-button
          color="warn"
          (click)="onDelete(batch.id)"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
</div>
